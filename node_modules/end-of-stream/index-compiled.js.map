{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var once = require('once');\n\nvar noop = function() {};\n\nvar isRequest = function(stream) {\n\treturn stream.setHeader && typeof stream.abort === 'function';\n};\n\nvar eos = function(stream, opts, callback) {\n\tif (typeof opts === 'function') return eos(stream, null, opts);\n\tif (!opts) opts = {};\n\n\tcallback = once(callback || noop);\n\n\tvar ws = stream._writableState;\n\tvar rs = stream._readableState;\n\tvar readable = opts.readable || (opts.readable !== false && stream.readable);\n\tvar writable = opts.writable || (opts.writable !== false && stream.writable);\n\n\tvar onlegacyfinish = function() {\n\t\tif (!stream.writable) onfinish();\n\t};\n\n\tvar onfinish = function() {\n\t\twritable = false;\n\t\tif (!readable) callback();\n\t};\n\n\tvar onend = function() {\n\t\treadable = false;\n\t\tif (!writable) callback();\n\t};\n\n\tvar onclose = function() {\n\t\tif (readable && !(rs && rs.ended)) return callback(new Error('premature close'));\n\t\tif (writable && !(ws && ws.ended)) return callback(new Error('premature close'));\n\t};\n\n\tvar onrequest = function() {\n\t\tstream.req.on('finish', onfinish);\n\t};\n\n\tif (isRequest(stream)) {\n\t\tstream.on('complete', onfinish);\n\t\tstream.on('abort', onclose);\n\t\tif (stream.req) onrequest();\n\t\telse stream.on('request', onrequest);\n\t} else if (writable && !ws) { // legacy streams\n\t\tstream.on('end', onlegacyfinish);\n\t\tstream.on('close', onlegacyfinish);\n\t}\n\n\tstream.on('end', onend);\n\tstream.on('finish', onfinish);\n\tif (opts.error !== false) stream.on('error', callback);\n\tstream.on('close', onclose);\n\n\treturn function() {\n\t\tstream.removeListener('complete', onfinish);\n\t\tstream.removeListener('abort', onclose);\n\t\tstream.removeListener('request', onrequest);\n\t\tif (stream.req) stream.req.removeListener('finish', onfinish);\n\t\tstream.removeListener('end', onlegacyfinish);\n\t\tstream.removeListener('close', onlegacyfinish);\n\t\tstream.removeListener('finish', onfinish);\n\t\tstream.removeListener('end', onend);\n\t\tstream.removeListener('error', callback);\n\t\tstream.removeListener('close', onclose);\n\t};\n};\n\nmodule.exports = eos;"]}