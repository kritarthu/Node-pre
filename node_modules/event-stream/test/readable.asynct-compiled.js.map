{"version":3,"sources":["readable.asynct.js"],"names":[],"mappings":"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","file":"readable.asynct-compiled.js","sourcesContent":["\nvar es = require('../')\n  , it = require('it-is').style('colour')\n  , u = require('ubelt')\n\nexports ['read an array'] = function (test) {\n\n\n  console.log('readable')\n  return test.end()\n  var readThis = u.map(3, 6, 100, u.id) //array of multiples of 3 < 100\n\n  console.log('readable')\n\n  var reader = \n    es.readable(function (i, callback) {\n      if(i >= readThis.length)\n        return this.emit('end')\n      console.log('readable')\n      callback(null, readThis[i])\n    })\n\n  var writer = es.writeArray(function (err, array){\n    if(err) throw err\n    it(array).deepEqual(readThis)\n    test.done()\n  })\n\n  reader.pipe(writer)\n}\n\nexports ['read an array - async'] = function (test) {\n\n  var readThis = u.map(3, 6, 100, u.id) //array of multiples of 3 < 100\n\n  var reader = \n    es.readable(function (i, callback) {\n      if(i >= readThis.length)\n        return this.emit('end')\n      u.delay(callback)(null, readThis[i])\n    })\n\n  var writer = es.writeArray(function (err, array){\n    if(err) throw err\n    it(array).deepEqual(readThis)\n    test.done()\n  })\n\n  reader.pipe(writer)\n}\n\n\nexports ['emit data then call next() also works'] = function (test) {\n\n  var readThis = u.map(3, 6, 100, u.id) //array of multiples of 3 < 100\n\n  var reader = \n    es.readable(function (i, next) {\n      if(i >= readThis.length)\n        return this.emit('end')\n      this.emit('data', readThis[i])\n      next()\n    })\n\n  var writer = es.writeArray(function (err, array){\n    if(err) throw err\n    it(array).deepEqual(readThis)\n    test.done()     \n  })\n\n  reader.pipe(writer)\n}\n\n\nexports ['callback emits error, then stops'] = function (test) {\n\n  var err = new Error('INTENSIONAL ERROR')\n    , called = 0\n\n  var reader = \n    es.readable(function (i, callback) {\n      if(called++)\n        return\n      callback(err)\n    })\n\n  reader.on('error', function (_err){\n    it(_err).deepEqual(err)\n    u.delay(function() {\n      it(called).equal(1)\n      test.done()\n    }, 50)()\n  })\n}\n\nexports['readable does not call read concurrently'] = function (test) {\n\n  var current = 0\n  var source = es.readable(function(count, cb){\n    current ++\n    if(count > 100)\n      return this.emit('end')\n    u.delay(function(){\n      current --\n      it(current).equal(0)      \n      cb(null, {ok: true, n: count});\n    })();\n  });\n\n  var destination = es.map(function(data, cb){\n    //console.info(data); \n    cb();\n  });\n\n  var all = es.connect(source, destination);\n\n  destination.on('end', test.done)\n}\n\nexports ['does not raise a warning: Recursive process.nextTick detected'] = function (test) {\n    var readThisDelayed;\n\n    u.delay(function () {\n        readThisDelayed = [1, 3, 5];\n    })();\n\n    es.readable(function (count, callback) {\n\n        if (readThisDelayed) {\n            var that = this;\n            readThisDelayed.forEach(function (item) {\n                that.emit('data', item);\n            });\n\n            this.emit('end');\n            test.done();\n        }\n\n        callback();\n    });\n};\n\n//\n// emitting multiple errors is not supported by stream.\n//\n// I do not think that this is a good idea, at least, there should be an option to pipe to \n// continue on error. it makes alot ef sense, if you are using Stream like I am, to be able to emit multiple errors.\n// an error might not necessarily mean the end of the stream. it depends on the error, at least.\n//\n// I will start a thread on the mailing list. I'd rather that than use a custom `pipe` implementation.\n// \n// basically, I want to be able use pipe to transform objects, and if one object is invalid, \n// the next might still be good, so I should get to choose if it's gonna stop.\n// re-enstate this test when this issue progresses.\n//\n// hmm. I could add this to es.connect by deregistering the error listener, \n// but I would rather it be an option in core.\n\n/*\nexports ['emit multiple errors, with 2nd parameter (continueOnError)'] = function (test) {\n\n  var readThis = d.map(1, 100, d.id)\n    , errors = 0\n  var reader = \n    es.readable(function (i, callback) {\n      console.log(i, readThis.length)\n      if(i >= readThis.length)\n        return this.emit('end')\n      if(!(readThis[i] % 7))\n        return callback(readThis[i])\n      callback(null, readThis[i])\n    }, true)\n\n  var writer = es.writeArray(function (err, array) {\n    if(err) throw err\n    it(array).every(function (u){\n      it(u % 7).notEqual(0)      \n    }).property('length', 80)\n    it(errors).equal(14)\n    test.done()     \n  })\n\n  reader.on('error', function (u) {\n    errors ++\n    console.log(u)\n    if('number' !== typeof u)\n      throw u\n\n    it(u % 7).equal(0)\n\n  })\n\n  reader.pipe(writer)\n}\n*/\n\nrequire('./helper')(module)\n"]}