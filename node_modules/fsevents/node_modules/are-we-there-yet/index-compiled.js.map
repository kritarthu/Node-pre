{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["\"use strict\"\nvar stream = require(\"readable-stream\")\nvar EventEmitter = require(\"events\").EventEmitter\nvar util = require(\"util\")\nvar delegate = require(\"delegates\")\n\nfunction noteChange (trackerGroup) {\n  return function (name) {\n    trackerGroup.emit('change', name || trackerGroup.name);\n  }\n}\n\nvar TrackerGroup = exports.TrackerGroup = function (name) {\n  EventEmitter.call(this)\n  this.name = name\n  this.trackGroup = []\n  this.totalWeight = 0\n  this.noteChange = noteChange(this)\n}\nutil.inherits(TrackerGroup, EventEmitter)\n\nTrackerGroup.prototype.completed = function () {\n  if (this.trackGroup.length==0) return 0\n  var valPerWeight = 1 / this.totalWeight\n  var completed = 0\n  for (var i = 0, len = this.trackGroup.length; i < len; i++){\n    var group = this.trackGroup[i];\n    completed += valPerWeight * group.weight *  group.completed()\n  }\n  return completed\n}\n\nTrackerGroup.prototype.addUnit = function (unit, weight, noChange) {\n  unit.weight = weight || 1\n  this.totalWeight += unit.weight\n  this.trackGroup.push(unit)\n  // Bubble events back up\n  unit.on(\"change\", this.noteChange)\n  if (! noChange) this.emit(\"change\", this.name)\n  return unit\n}\n\nTrackerGroup.prototype.newGroup = function (name, weight) {\n  return this.addUnit(new TrackerGroup(name), weight)\n}\n\nTrackerGroup.prototype.newItem = function (name, todo, weight) {\n  return this.addUnit(new Tracker(name, todo), weight)\n}\n\nTrackerGroup.prototype.newStream = function (name, todo, weight) {\n  return this.addUnit(new TrackerStream(name, todo), weight)\n}\n\nTrackerGroup.prototype.finish = function () {\n  if (! this.trackGroup.length) this.addUnit(new Tracker(), 1, true)\n  for (var i = 0, len = this.trackGroup.length; i < len; i++) {\n    var group = this.trackGroup[i]\n    group.removeListener(\"change\", this.noteChange)\n    group.finish()\n  }\n  this.emit(\"change\", this.name)\n}\n\nvar buffer = \"                                  \"\nTrackerGroup.prototype.debug = function (depth) {\n  depth = depth || 0\n  var indent = depth ? buffer.substr(0,depth) : \"\"\n  var output = indent + (this.name||\"top\") + \": \" + this.completed() + \"\\n\"\n  this.trackGroup.forEach(function(T) {\n    if (T instanceof TrackerGroup) {\n      output += T.debug(depth + 1)\n    }\n    else {\n      output += indent + \" \" + T.name + \": \" + T.completed() + \"\\n\"\n    }\n  })\n  return output\n}\n\nvar Tracker = exports.Tracker = function (name,todo) {\n  EventEmitter.call(this)\n  this.name = name\n  this.workDone =  0\n  this.workTodo = todo || 0\n}\nutil.inherits(Tracker, EventEmitter)\n\nTracker.prototype.completed = function () {\n  return this.workTodo === 0 ? 0 : this.workDone / this.workTodo\n}\n\nTracker.prototype.addWork = function (work) {\n  this.workTodo += work\n  this.emit(\"change\", this.name)\n}\n\nTracker.prototype.completeWork = function (work) {\n  this.workDone += work\n  if (this.workDone > this.workTodo) this.workDone = this.workTodo\n  this.emit(\"change\", this.name)\n}\n\nTracker.prototype.finish = function () {\n  this.workTodo = this.workDone = 1\n  this.emit(\"change\", this.name)\n}\n\n\nvar TrackerStream = exports.TrackerStream = function (name, size, options) {\n  stream.Transform.call(this, options)\n  this.tracker = new Tracker(name, size)\n  this.name = name\n  var self = this\n  this.tracker.on(\"change\", function (name) { self.emit(\"change\", name) })\n}\nutil.inherits(TrackerStream, stream.Transform)\n\nTrackerStream.prototype._transform = function (data, encoding, cb) {\n  this.tracker.completeWork(data.length ? data.length : 1)\n  this.push(data)\n  cb()\n}\n\nTrackerStream.prototype._flush = function (cb) {\n  this.tracker.finish()\n  cb()\n}\n\ndelegate(TrackerStream.prototype, \"tracker\")\n  .method(\"completed\")\n  .method(\"addWork\")\n"]}