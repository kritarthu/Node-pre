{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AACb,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC7B,IAAI,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;AAC5B,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,WAAW,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACzC,IAAI,YAAY,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC5C,IAAI,aAAa,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC9C,IAAI,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACrC,IAAI,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACpC,IAAI,aAAa,GAAG,OAAO,CAAC,iBAAiB,CAAC,CAAC;AAC/C,IAAI,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AACpC,IAAI,WAAW,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;AAC1C,IAAI,aAAa,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC9C,IAAI,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AACxC,IAAI,iBAAiB,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAC;;AAEvD,SAAS,QAAQ,CAAC,OAAO,EAAE,MAAM,EAAE;AAClC,kBAAiB,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;AAC9C,aAAY,CAAC,IAAI,EAAE,MAAM,EAAE,EAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAC,CAAC,CAAC;CAClD;;AAED,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;AAC3C,QAAQ,CAAC,SAAS,CAAC,IAAI,GAAG,UAAU,CAAC;;AAErC,SAAS,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE;AAC3B,KAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;AACvD,QAAM,IAAI,QAAQ,CAAC,kDAAkD,GAAG,OAAO,GAAG,CAAC,CAAC;EACpF;;AAED,KAAI,OAAO,IAAI,KAAK,UAAU,EAAE;AAC/B,IAAE,GAAG,IAAI,CAAC;AACV,MAAI,GAAG,EAAE,CAAC;EACV;;AAED,KAAI,GAAG,YAAY,CAClB;AACC,UAAQ,EAAE,OAAO;EACjB,EACD,OAAO,GAAG,KAAK,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,EAC9D,IAAI,CACJ,CAAC;;AAEF,KAAI,CAAC,OAAO,GAAG,YAAY,CAAC;AAC3B,cAAY,EAAE,qCAAqC;AACnD,mBAAiB,EAAE,cAAc;EACjC,EAAE,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;;AAEhC,KAAI,IAAI,CAAC,QAAQ,EAAE;AAClB,MAAI,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC;EAC1B;;AAED,KAAI,IAAI,CAAC,KAAK,EAAE;AACf,MAAI,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,EAAE;AACnC,OAAI,CAAC,KAAK,GAAG,WAAW,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;GAC/C;;AAED,MAAI,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC;AAC7C,SAAO,IAAI,CAAC,KAAK,CAAC;EAClB;;AAED,KAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC7B,KAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AACrB,KAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AACrB,KAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAC3B,KAAI,KAAK,CAAC;AACV,KAAI,aAAa,GAAG,CAAC,CAAC;;AAEtB,QAAO,IAAI,CAAC,QAAQ,CAAC;AACrB,QAAO,IAAI,CAAC,IAAI,CAAC;AACjB,QAAO,IAAI,CAAC,IAAI,CAAC;AACjB,QAAO,IAAI,CAAC,OAAO,CAAC;;AAEpB,KAAI,IAAI,EAAE;AACT,MAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,kBAAkB,CAAC;EAChE;;AAED,KAAI,IAAI,EAAE;AACT,MAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AACnF,SAAM,IAAI,QAAQ,CAAC,yDAAyD,CAAC,CAAC;GAC9E;;AAED,MAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC;;AAEpC,MAAI,CAAC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AACtG,OAAI,MAAM,GAAG,OAAO,IAAI,KAAK,QAAQ,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC;AAC9E,OAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,GAAG,MAAM,CAAC;GACxC;EACD;;AAED,KAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC;;;;AAInC,KAAI,CAAC,EAAE,EAAE;AACR,OAAK,GAAG,SAAS,EAAE,CAAC;;;AAGpB,IAAE,GAAG,UAAU,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE;AACnC,QAAK,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;GACzC,CAAC;EACF;;AAED,KAAI,KAAK,IAAI,IAAI,EAAE;AAClB,QAAM,IAAI,QAAQ,CAAC,yDAAyD,CAAC,CAAC;EAC9E;;AAED,UAAS,GAAG,CAAC,IAAI,EAAE,EAAE,EAAE;AACtB,MAAI,EAAE,GAAG,IAAI,CAAC,QAAQ,KAAK,QAAQ,GAAG,KAAK,GAAG,IAAI,CAAC;AACnD,MAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;;AAE9B,MAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;AAC7B,OAAI,CAAC,KAAK,GAAG,aAAa,CAAC,EAAE,KAAK,KAAK,GAAG,OAAO,GAAG,MAAM,CAAC,CAAC,WAAW,CAAC;;AAExE,OAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,KAAK,KACzD,OAAO,IAAI,CAAC,EAAE,KAAK,WAAW,IAC9B,OAAO,IAAI,CAAC,IAAI,KAAK,WAAW,IAChC,OAAO,IAAI,CAAC,OAAO,KAAK,WAAW,IACnC,OAAO,IAAI,CAAC,GAAG,KAAK,WAAW,IAC/B,OAAO,IAAI,CAAC,UAAU,KAAK,WAAW,IACtC,OAAO,IAAI,CAAC,GAAG,KAAK,WAAW,IAC/B,OAAO,IAAI,CAAC,kBAAkB,KAAK,WAAW,CAAA,AAAC,EAAE;AACjD,QAAI,CAAC,KAAK,GAAG,IAAI,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC;AAC1C,OAAE,EAAE,IAAI,CAAC,EAAE;AACX,SAAI,EAAE,IAAI,CAAC,IAAI;AACf,YAAO,EAAE,IAAI,CAAC,OAAO;AACrB,QAAG,EAAE,IAAI,CAAC,GAAG;AACb,eAAU,EAAE,IAAI,CAAC,UAAU;AAC3B,QAAG,EAAE,IAAI,CAAC,GAAG;AACb,uBAAkB,EAAE,IAAI,CAAC,kBAAkB;KAC3C,CAAC,CAAC;IACH;GACD;;AAED,MAAI,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,QAAQ,EAAE;AAC9C,OAAI,UAAU,GAAG,QAAQ,CAAC,UAAU,CAAC;AACrC,OAAI,GAAG,GAAG,QAAQ,CAAC;;;AAGnB,OAAI,UAAU,CAAC,UAAU,CAAC,IAAI,UAAU,IAAI,GAAG,CAAC,OAAO,KAAK,IAAI,CAAC,MAAM,KAAK,KAAK,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,CAAA,AAAC,EAAE;;AAE7G,OAAG,CAAC,MAAM,EAAE,CAAC;;AAEb,QAAI,EAAE,aAAa,GAAG,EAAE,EAAE;AACzB,OAAE,CAAC,IAAI,QAAQ,CAAC,gCAAgC,CAAC,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;AACnE,YAAO;KACP;;AAED,QAAI,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC5D,QAAI,YAAY,GAAG,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC;;AAErE,QAAI,IAAI,CAAC,KAAK,KAAK,aAAa,CAAC,IAAI,CAAC,WAAW,IAAI,YAAY,CAAC,QAAQ,KAAK,QAAQ,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;AACrH,iBAAY,CAAC,KAAK,GAAG,SAAS,CAAC;KAC/B;;AAED,QAAI,KAAK,EAAE;AACV,UAAK,CAAC,IAAI,CAAC,UAAU,EAAE,GAAG,EAAE,YAAY,CAAC,CAAC;KAC1C;;AAED,OAAG,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;AACtB,WAAO;IACP;;AAED,OAAI,KAAK,EAAE;AACV,SAAK,CAAC,IAAI,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;IAC5B;;AAED,OAAI,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;AACxE,OAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;IACnC;;AAED,OAAI,UAAU,GAAG,GAAG,IAAI,UAAU,GAAG,GAAG,EAAE;AACzC,iBAAa,CAAC,GAAG,EAAE,QAAQ,EAAE,UAAU,GAAG,EAAE,IAAI,EAAE;AACjD,QAAG,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,GAAG,oBAAoB,GAAG,UAAU,GAAG,IAAI,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,GAAG,GAAG,EAAE,GAAG,CAAC,CAAC;AAClI,QAAG,CAAC,IAAI,GAAG,UAAU,CAAC;;AAEtB,SAAI,IAAI,IAAI,IAAI,EAAE;AACjB,UAAI;AACH,WAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;OACxB,CAAC,OAAO,CAAC,EAAE;AACX,UAAG,GAAG,IAAI,QAAQ,CAAC,UAAU,GAAG,GAAG,GAAG,kBAAkB,EAAE,IAAI,QAAQ,CAAC,CAAC,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;OACxF;MACD;;AAED,OAAE,CAAC,GAAG,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;KACxB,CAAC,CAAC;;AAEH,WAAO;IACP;;;AAGD,OAAI,KAAK,EAAE;AACV,SAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;AACvB,WAAO;IACP;;AAED,gBAAa,CAAC,GAAG,EAAE,QAAQ,EAAE,UAAU,GAAG,EAAE,IAAI,EAAE;AACjD,QAAI,GAAG,EAAE;AACR,QAAG,GAAG,IAAI,QAAQ,CAAC,UAAU,GAAG,GAAG,GAAG,kBAAkB,EAAE,GAAG,CAAC,CAAC;KAC/D,MAAM,IAAI,IAAI,IAAI,UAAU,KAAK,GAAG,EAAE;;;AAGtC,SAAI;AACH,UAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;MACxB,CAAC,OAAO,CAAC,EAAE;AACX,SAAG,GAAG,IAAI,QAAQ,CAAC,UAAU,GAAG,GAAG,GAAG,kBAAkB,EAAE,CAAC,CAAC,CAAC;MAC7D;KACD;;AAED,MAAE,CAAC,GAAG,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;IACxB,CAAC,CAAC;GACH,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE;AAC/B,KAAE,CAAC,IAAI,QAAQ,CAAC,aAAa,GAAG,GAAG,GAAG,SAAS,EAAE,GAAG,CAAC,CAAC,CAAC;GACvD,CAAC,CAAC;;AAEH,MAAI,OAAO,EAAE;AACZ,WAAQ,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;GACvB;;AAED,MAAI,CAAC,KAAK,EAAE;AACX,OAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AAC5B,QAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACf,MAAM;AACN,OAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACd;;AAED,UAAO;GACP;;AAED,MAAI,IAAI,EAAE;AACT,QAAK,CAAC,KAAK,GAAG,YAAY;AACzB,UAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;IAC3E,CAAC;;AAEF,OAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AAC5B,QAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACf,MAAM;AACN,OAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACd;;AAED,UAAO;GACP;;AAED,MAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,KAAK,IAAI,IAAI,CAAC,MAAM,KAAK,OAAO,EAAE;AAC/E,QAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;AACvB,UAAO;GACP;;AAED,KAAG,CAAC,GAAG,EAAE,CAAC;EACV;;AAED,IAAG,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;;AAEd,QAAO,KAAK,CAAC;CACb;;AAED,CACC,KAAK,EACL,MAAM,EACN,KAAK,EACL,OAAO,EACP,MAAM,EACN,QAAQ,CACR,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE;AACvB,IAAG,CAAC,EAAE,CAAC,GAAG,UAAU,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE;AAClC,MAAI,OAAO,IAAI,KAAK,UAAU,EAAE;AAC/B,KAAE,GAAG,IAAI,CAAC;AACV,OAAI,GAAG,EAAE,CAAC;GACV;;AAED,SAAO,GAAG,CAAC,GAAG,EAAE,YAAY,CAAC,EAAE,EAAE,IAAI,EAAE,EAAC,MAAM,EAAE,EAAE,CAAC,WAAW,EAAE,EAAC,CAAC,EAAE,EAAE,CAAC,CAAC;EACxE,CAAC;CACF,CAAC,CAAC;;AAEH,MAAM,CAAC,OAAO,GAAG,GAAG,CAAC","file":"index-compiled.js","sourcesContent":["'use strict';\nvar http = require('http');\nvar https = require('https');\nvar urlLib = require('url');\nvar util = require('util');\nvar zlib = require('zlib');\nvar querystring = require('querystring');\nvar objectAssign = require('object-assign');\nvar infinityAgent = require('infinity-agent');\nvar duplexify = require('duplexify');\nvar isStream = require('is-stream');\nvar readAllStream = require('read-all-stream');\nvar timedOut = require('timed-out');\nvar prependHttp = require('prepend-http');\nvar lowercaseKeys = require('lowercase-keys');\nvar isRedirect = require('is-redirect');\nvar NestedErrorStacks = require('nested-error-stacks');\n\nfunction GotError(message, nested) {\n\tNestedErrorStacks.call(this, message, nested);\n\tobjectAssign(this, nested, {nested: this.nested});\n}\n\nutil.inherits(GotError, NestedErrorStacks);\nGotError.prototype.name = 'GotError';\n\nfunction got(url, opts, cb) {\n\tif (typeof url !== 'string' && typeof url !== 'object') {\n\t\tthrow new GotError('Parameter `url` must be a string or object, not ' + typeof url);\n\t}\n\n\tif (typeof opts === 'function') {\n\t\tcb = opts;\n\t\topts = {};\n\t}\n\n\topts = objectAssign(\n\t\t{\n\t\t\tprotocol: 'http:'\n\t\t},\n\t\ttypeof url === 'string' ? urlLib.parse(prependHttp(url)) : url,\n\t\topts\n\t);\n\n\topts.headers = objectAssign({\n\t\t'user-agent': 'https://github.com/sindresorhus/got',\n\t\t'accept-encoding': 'gzip,deflate'\n\t}, lowercaseKeys(opts.headers));\n\n\tif (opts.pathname) {\n\t\topts.path = opts.pathname;\n\t}\n\n\tif (opts.query) {\n\t\tif (typeof opts.query !== 'string') {\n\t\t\topts.query = querystring.stringify(opts.query);\n\t\t}\n\n\t\topts.path = opts.pathname + '?' + opts.query;\n\t\tdelete opts.query;\n\t}\n\n\tvar encoding = opts.encoding;\n\tvar body = opts.body;\n\tvar json = opts.json;\n\tvar timeout = opts.timeout;\n\tvar proxy;\n\tvar redirectCount = 0;\n\n\tdelete opts.encoding;\n\tdelete opts.body;\n\tdelete opts.json;\n\tdelete opts.timeout;\n\n\tif (json) {\n\t\topts.headers.accept = opts.headers.accept || 'application/json';\n\t}\n\n\tif (body) {\n\t\tif (typeof body !== 'string' && !Buffer.isBuffer(body) && !isStream.readable(body)) {\n\t\t\tthrow new GotError('options.body must be a ReadableStream, string or Buffer');\n\t\t}\n\n\t\topts.method = opts.method || 'POST';\n\n\t\tif (!opts.headers['content-length'] && !opts.headers['transfer-encoding'] && !isStream.readable(body)) {\n\t\t\tvar length = typeof body === 'string' ? Buffer.byteLength(body) : body.length;\n\t\t\topts.headers['content-length'] = length;\n\t\t}\n\t}\n\n\topts.method = opts.method || 'GET';\n\n\t// returns a proxy stream to the response\n\t// if no callback has been provided\n\tif (!cb) {\n\t\tproxy = duplexify();\n\n\t\t// forward errors on the stream\n\t\tcb = function (err, data, response) {\n\t\t\tproxy.emit('error', err, data, response);\n\t\t};\n\t}\n\n\tif (proxy && json) {\n\t\tthrow new GotError('got can not be used as stream when options.json is used');\n\t}\n\n\tfunction get(opts, cb) {\n\t\tvar fn = opts.protocol === 'https:' ? https : http;\n\t\tvar url = urlLib.format(opts);\n\n\t\tif (opts.agent === undefined) {\n\t\t\topts.agent = infinityAgent[fn === https ? 'https' : 'http'].globalAgent;\n\n\t\t\tif (process.version.indexOf('v0.10') === 0 && fn === https && (\n\t\t\t\ttypeof opts.ca !== 'undefined' ||\n\t\t\t\ttypeof opts.cert !== 'undefined' ||\n\t\t\t\ttypeof opts.ciphers !== 'undefined' ||\n\t\t\t\ttypeof opts.key !== 'undefined' ||\n\t\t\t\ttypeof opts.passphrase !== 'undefined' ||\n\t\t\t\ttypeof opts.pfx !== 'undefined' ||\n\t\t\t\ttypeof opts.rejectUnauthorized !== 'undefined')) {\n\t\t\t\topts.agent = new infinityAgent.https.Agent({\n\t\t\t\t\tca: opts.ca,\n\t\t\t\t\tcert: opts.cert,\n\t\t\t\t\tciphers: opts.ciphers,\n\t\t\t\t\tkey: opts.key,\n\t\t\t\t\tpassphrase: opts.passphrase,\n\t\t\t\t\tpfx: opts.pfx,\n\t\t\t\t\trejectUnauthorized: opts.rejectUnauthorized\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tvar req = fn.request(opts, function (response) {\n\t\t\tvar statusCode = response.statusCode;\n\t\t\tvar res = response;\n\n\t\t\t// auto-redirect only for GET and HEAD methods\n\t\t\tif (isRedirect(statusCode) && 'location' in res.headers && (opts.method === 'GET' || opts.method === 'HEAD')) {\n\t\t\t\t// discard response\n\t\t\t\tres.resume();\n\n\t\t\t\tif (++redirectCount > 10) {\n\t\t\t\t\tcb(new GotError('Redirected 10 times. Aborting.'), undefined, res);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar redirectUrl = urlLib.resolve(url, res.headers.location);\n\t\t\t\tvar redirectOpts = objectAssign({}, opts, urlLib.parse(redirectUrl));\n\n\t\t\t\tif (opts.agent === infinityAgent.http.globalAgent && redirectOpts.protocol === 'https:' && opts.protocol === 'http:') {\n\t\t\t\t\tredirectOpts.agent = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (proxy) {\n\t\t\t\t\tproxy.emit('redirect', res, redirectOpts);\n\t\t\t\t}\n\n\t\t\t\tget(redirectOpts, cb);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (proxy) {\n\t\t\t\tproxy.emit('response', res);\n\t\t\t}\n\n\t\t\tif (['gzip', 'deflate'].indexOf(res.headers['content-encoding']) !== -1) {\n\t\t\t\tres = res.pipe(zlib.createUnzip());\n\t\t\t}\n\n\t\t\tif (statusCode < 200 || statusCode > 299) {\n\t\t\t\treadAllStream(res, encoding, function (err, data) {\n\t\t\t\t\terr = new GotError(opts.method + ' ' + url + ' response code is ' + statusCode + ' (' + http.STATUS_CODES[statusCode] + ')', err);\n\t\t\t\t\terr.code = statusCode;\n\n\t\t\t\t\tif (data && json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\terr = new GotError('Parsing ' + url + ' response failed', new GotError(e.message, err));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcb(err, data, response);\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// pipe the response to the proxy if in proxy mode\n\t\t\tif (proxy) {\n\t\t\t\tproxy.setReadable(res);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treadAllStream(res, encoding, function (err, data) {\n\t\t\t\tif (err) {\n\t\t\t\t\terr = new GotError('Reading ' + url + ' response failed', err);\n\t\t\t\t} else if (json && statusCode !== 204) {\n\t\t\t\t\t// only parse json if the option is enabled, and the response\n\t\t\t\t\t// is not a 204 (empty reponse)\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\terr = new GotError('Parsing ' + url + ' response failed', e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcb(err, data, response);\n\t\t\t});\n\t\t}).once('error', function (err) {\n\t\t\tcb(new GotError('Request to ' + url + ' failed', err));\n\t\t});\n\n\t\tif (timeout) {\n\t\t\ttimedOut(req, timeout);\n\t\t}\n\n\t\tif (!proxy) {\n\t\t\tif (isStream.readable(body)) {\n\t\t\t\tbody.pipe(req);\n\t\t\t} else {\n\t\t\t\treq.end(body);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (body) {\n\t\t\tproxy.write = function () {\n\t\t\t\tthrow new Error('got\\'s stream is not writable when options.body is used');\n\t\t\t};\n\n\t\t\tif (isStream.readable(body)) {\n\t\t\t\tbody.pipe(req);\n\t\t\t} else {\n\t\t\t\treq.end(body);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (opts.method === 'POST' || opts.method === 'PUT' || opts.method === 'PATCH') {\n\t\t\tproxy.setWritable(req);\n\t\t\treturn;\n\t\t}\n\n\t\treq.end();\n\t}\n\n\tget(opts, cb);\n\n\treturn proxy;\n}\n\n[\n\t'get',\n\t'post',\n\t'put',\n\t'patch',\n\t'head',\n\t'delete'\n].forEach(function (el) {\n\tgot[el] = function (url, opts, cb) {\n\t\tif (typeof opts === 'function') {\n\t\t\tcb = opts;\n\t\t\topts = {};\n\t\t}\n\n\t\treturn got(url, objectAssign({}, opts, {method: el.toUpperCase()}), cb);\n\t};\n});\n\nmodule.exports = got;\n"]}